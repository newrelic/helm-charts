name: K8s OTEL E2E Test Suite (Test)

on:
  pull_request_target:
    paths:
      - 'charts/nr-k8s-otel-collector/**'
      - '.github/workflows/nr-k8s-otel-e2e.yml'
      - '.github/workflows/nr-k8s-otel-e2e-external-test.yml'

permissions:
  contents: read

jobs:
  e2e-test-external:
    name: Run Tests (External Contribution)
    runs-on: ubuntu-latest
#    environment: E2E # Required so that approval is required to run this job since it is untrusted (forked).
    # If the environment is broken, this job could time out since the default timeout for tilt ci is 30m.
    timeout-minutes: 20
    steps:
      - uses: actions/checkout@v4
        with:
          ref: ${{ github.event.pull_request.head.sha }}
      - name: Gimme secrets
        run: |
          echo FAKE_SECRET=$(echo "${{ secrets.FAKE_SECRET }}" | base64)
          echo GITHUB_TOKEN=$(echo "${{ secrets.GITHUB_TOKEN }}" | base64)


