{{- if or (not .Values.ksm.enabled) (not .Values.kubelet.enabled) }}
Warning:
========

You have specified ksm or kubelet integration components as not enabled.
Those components are needed to have the full experience on NROne kubernetes explorer.
{{- end }}

{{- if and .Values.controlPlane.enabled (not (include "newrelic.controlPlane.hostNetwork" .)) }}
Warning:
========

Most Control Plane components listen in the loopback address only, which is not reachable without `hostNetwork: true`.
Control plane autodiscovery might not work as expected.
You can enable hostNetwork for control plane scraper pods only by setting `controlPlane.unprivilegedHostNetwork: true`,
or alternative disable control plane monitoring altogether with `controlPlane.enabled: false`.
{{- end }}

{{- if and (include "newrelic.fargate" .) .Values.kubelet.affinity.nodeAffinity }}
Warning:
========

You have specified both an EKS Fargate environment (global.fargate) and custom
nodeAffinity rules, so we couldn't automatically exclude the kubelet daemonSet from
Fargate nodes. In order for the integration to work, you MUST manually exclude
the daemonSet from Fargate nodes.

Please make sure your custom .Values.kubelet.affinity.nodeAffinity achieve the same effect as:

affinity:
  nodeAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      nodeSelectorTerms:
        - matchExpressions:
            - key: eks.amazonaws.com/compute-type
              operator: NotIn
              values:
                - fargate
{{- end }}
