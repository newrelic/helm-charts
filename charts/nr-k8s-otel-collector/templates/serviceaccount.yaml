{{- if eq (include "newrelic.common.serviceAccount.create" .) "true" }}
---
# ServiceAccount for StatefulSet collector
# Permissions: cluster-wide metrics scraping (kube-state-metrics, control plane components)
apiVersion: v1
kind: ServiceAccount
metadata:
  name: {{ include "nrKubernetesOtel.deployment.serviceAccountName" . }}
  namespace: {{ .Release.Namespace }}
  labels:
{{- include "newrelic.common.labels" . | nindent 4 }}
    app.kubernetes.io/component: statefulset-collector
  annotations:
{{- include "newrelic.common.serviceAccount.annotations" . | nindent 4 }}
---
# ServiceAccount for DaemonSet collector
# Permissions: node-local metrics scraping (kubelet, cadvisor) including nodes/stats access
apiVersion: v1
kind: ServiceAccount
metadata:
  name: {{ include "nrKubernetesOtel.daemonset.serviceAccountName" . }}
  namespace: {{ .Release.Namespace }}
  labels:
{{- include "newrelic.common.labels" . | nindent 4 }}
    app.kubernetes.io/component: daemonset-collector
  annotations:
{{- include "newrelic.common.serviceAccount.annotations" . | nindent 4 }}
{{- end -}}
